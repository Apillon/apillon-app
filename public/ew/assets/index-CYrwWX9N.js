(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();const Ye=Object.freeze({dictionary:"object",mode:"strict"}),L=Symbol("EMPTY_KEY"),Se=Symbol("OMIT_VALUE"),jn=5960464477539063e-23,kt=4294967296,Qe=9007199254740992,Et=18446744073709551616n,At=8192,he=6,Pt=64,jt=69,Gt=70,Jt=72,Wt=77,qt=78,Yt=85,Kt=86;function Gn(o,e){return typeof Object.is=="function"?Object.is(o,e):o===e?o!==0||1/o===1/e:o!==o&&e!==e}function Jn(o){function e(s){return typeof s=="string"&&["object","map"].includes(s)}function t(s){return typeof s=="string"&&["loose","strict","sequence"].includes(s)}const i={...Ye};return typeof o=="object"&&(i.dictionary=e(o.dictionary)?o.dictionary:Ye.dictionary,i.mode=t(o.mode)?o.mode:Ye.mode),Object.freeze(i)}function Wn(o,e){const t=Math.min(o.byteLength,e.byteLength);for(let i=0;i<t;i++){const s=o[i]-e[i];if(s!==0)return s}return o.byteLength-e.byteLength}var vt=function(o,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?o!==e||!i:!e.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(o):i?i.value:e.get(o)},He,Ke;let et=class tt{static from(e){return new tt(Array.from(e))}constructor(e){He.add(this),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e?this._data=e:this._data=[]}add(e){return this._data.push(e)-1}remove(e){return this._data.splice(e,1)[0]}get(e){return this._data[e]}clone(){return new tt(this.data)}get data(){return Array.from(this._data)}get size(){return this._data.length}[(He=new WeakSet,Symbol.toStringTag)](){return"Sequence"}[(Ke=function(t){return`${this[Symbol.toStringTag]()}(${this.size}) ${t(this._data)}`},Symbol.for("Deno.customInspect"))](e){return vt(this,He,"m",Ke).call(this,e)}[Symbol.for("nodejs.util.inspect.custom")](e,t,i){return vt(this,He,"m",Ke).call(this,i)}};class de{static create(e){if(e===void 0)return new de(23);if(e===null)return new de(22);if(e===!0)return new de(21);if(e===!1)return new de(20);if(typeof e=="number"&&e>=0&&e<=255)return new de(e);throw new Error("CBORError: Value out of range or not a simple value.")}constructor(e){switch(Object.defineProperty(this,"semantic",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!0){case e===20:this.semantic="false";break;case e===21:this.semantic="true";break;case e===22:this.semantic="null";break;case e===23:this.semantic="undefined";break;case(e>23&&e<32):this.semantic="reserved";break;default:this.semantic="unassigned";break}this.value=e}toPrimitive(){switch(this.semantic){case"false":return!1;case"true":return!0;case"null":return null;case"undefined":default:return}}}class Xt{constructor(e,t){Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tag",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e,this.tag=t}}function zt(o,e,t={}){const{dictionary:i,mode:s}=Jn(t),l=s==="sequence"||s==="strict",u=new DataView(o),g=new Uint8Array(o);let d=0,B=function(w,b){return b};typeof e=="function"&&(B=e);function f(w,b){return d+=w,b}function p(w){return f(w,new Uint8Array(o,d,w))}function v(){const w=new ArrayBuffer(4),b=new DataView(w),N=oe(),k=N&32768;let E=N&31744;const A=N&1023;if(E===31744)E=261120;else if(E!==0)E+=114688;else if(A!==0)return(k?-1:1)*A*jn;return b.setUint32(0,k<<16|E<<13|A<<13),b.getFloat32(0)}function I(){return f(4,u.getFloat32(d))}function D(){return f(8,u.getFloat64(d))}function P(){return f(1,g[d])}function oe(){return f(2,u.getUint16(d))}function Y(){return f(4,u.getUint32(d))}function C(){return f(8,u.getBigUint64(d))}function we(){return g[d]!==255?!1:(d+=1,!0)}function ae(w){if(w<24)return w;if(w===24)return P();if(w===25)return oe();if(w===26)return Y();if(w===27){const b=C();return b<Qe?Number(b):b}if(w===31)return-1;throw new Error("CBORError: Invalid length encoding")}function be(w){const b=P();if(b===255)return-1;const N=ae(b&31);if(N<0||b>>5!==w)throw new Error("CBORError: Invalid indefinite length element");return Number(N)}function j(w,b){for(let N=0;N<b;++N){let k=P();k&128&&(k<224?(k=(k&31)<<6|P()&63,b-=1):k<240?(k=(k&15)<<12|(P()&63)<<6|P()&63,b-=2):(k=(k&15)<<18|(P()&63)<<12|(P()&63)<<6|P()&63,b-=3)),k<65536?w.push(k):(k-=65536,w.push(55296|k>>10),w.push(56320|k&1023))}}function G(){const w=P(),b=w>>5,N=w&31;let k,E;if(b===7)switch(N){case 25:return v();case 26:return I();case 27:return D()}if(E=ae(N),E<0&&(b<2||6<b))throw new Error("CBORError: Invalid length");switch(b){case 0:return B(L,E);case 1:return typeof E=="number"?B(L,-1-E):B(L,-1n-E);case 2:{if(E<0){const A=[];let T=0;for(;(E=be(b))>=0;)T+=E,A.push(p(E));const S=new Uint8Array(T);let M=0;for(k=0;k<A.length;++k)S.set(A[k],M),M+=A[k].length;return B(L,S)}return B(L,p(E))}case 3:{const A=[];if(E<0)for(;(E=be(b))>=0;)j(A,E);else j(A,E);let T="";for(k=0;k<A.length;k+=At)T+=String.fromCharCode.apply(null,A.slice(k,k+At));return B(L,T)}case 4:{let A;if(E<0){A=[];let T=0;for(;!we();)A.push(B(T++,G()))}else for(A=new Array(E),k=0;k<E;++k)A[k]=B(k,G());return B(L,A)}case 5:{if(i==="map"){const T=new Map;for(k=0;k<E||E<0&&!we();++k){const S=G();if(l&&T.has(S))throw new Error("CBORError: Duplicate key encountered");T.set(S,B(S,G()))}return B(L,T)}const A={};for(k=0;k<E||E<0&&!we();++k){const T=G();if(l&&Object.prototype.hasOwnProperty.call(A,T))throw new Error("CBORError: Duplicate key encountered");A[T]=B(T,G())}return B(L,A)}case 6:{const A=G(),T=E;if(A instanceof Uint8Array){const S=A.buffer.slice(A.byteOffset,A.byteLength+A.byteOffset);switch(T){case Pt:return B(L,new Uint8Array(S));case Jt:return B(L,new Int8Array(S));case jt:return B(L,new Uint16Array(S));case Wt:return B(L,new Int16Array(S));case Gt:return B(L,new Uint32Array(S));case qt:return B(L,new Int32Array(S));case Yt:return B(L,new Float32Array(S));case Kt:return B(L,new Float64Array(S))}}return B(L,new Xt(A,T))}case 7:switch(E){case 20:return B(L,!1);case 21:return B(L,!0);case 22:return B(L,null);case 23:return B(L,void 0);default:return B(L,new de(E))}}}const K=G();if(d!==o.byteLength){if(s!=="sequence")throw new Error("CBORError: Remaining bytes");const w=new et([K]);for(;d<o.byteLength;)w.add(B(L,G()));return w}return s==="sequence"?new et([K]):K}function qn(o,e,t){return zt(o,e,t)}function Zt(o,e){let t=new ArrayBuffer(256),i=new DataView(t),s=new Uint8Array(t),l,u=0,g=(w,b)=>b;if(typeof e=="function"&&(g=e),Array.isArray(e)){const w=e.slice();g=(b,N)=>b===L||w.includes(b)?N:Se}function d(w){let b=t.byteLength;const N=u+w;for(;b<N;)b<<=1;if(b!==t.byteLength){const k=i;t=new ArrayBuffer(b),i=new DataView(t),s=new Uint8Array(t);const E=u+3>>2;for(let A=0;A<E;++A)i.setUint32(A<<2,k.getUint32(A<<2))}return l=w,i}function B(...w){u+=l}function f(w){B(d(8).setFloat64(u,w))}function p(w){B(d(1).setUint8(u,w))}function v(w){d(w.length),s.set(w,u),B()}function I(w){B(d(2).setUint16(u,w))}function D(w){B(d(4).setUint32(u,w))}function P(w){const b=w%kt,N=(w-b)/kt,k=d(8);k.setUint32(u,N),k.setUint32(u+4,b),B()}function oe(w){B(d(8).setBigUint64(u,w))}function Y(w,b){w<=255?w<24?p(Number(w)|b):(p(24|b),p(Number(w))):w<=65535?(p(25|b),I(Number(w))):w<=4294967295?(p(26|b),D(Number(w))):(p(27|b),typeof w=="number"?P(w):oe(w))}function C(w,b){b<24?p(w<<5|b):b<256?(p(w<<5|24),p(b)):b<65536?(p(w<<5|25),I(b)):b<4294967296?(p(w<<5|26),D(b)):(p(w<<5|27),P(b))}function we(w){const b=u,N=w.length;let k=0;C(4,N);const E=u;for(let A=0;A<N;A+=1){const T=g(A,w[A]);T!==Se&&(j(T),k+=1)}if(N>k){const A=s.slice(E,u);u=b,C(4,k),v(A)}}function ae(w){const b=[],N=u;let k=u,E=0,A=0;if(w instanceof Map){E=w.size,C(5,E),k=u;for(const[S,M]of w.entries()){const X=g(S,M);if(X===Se)continue;let re=u;j(S);const ye=s.slice(re,u);re=u,j(X);const Ie=s.slice(re,u);A+=1,b.push([ye,Ie])}}else{const S=Object.keys(w);E=S.length,C(5,E),k=u;for(let M=0;M<E;M+=1){const X=S[M],re=g(X,w[X]);if(re===Se)continue;let ye=u;j(X);const Ie=s.slice(ye,u);ye=u,j(re);const Ge=s.slice(ye,u);A+=1,b.push([Ie,Ge])}}function T(S){u=N,C(5,A),b.sort(([M],[X])=>Wn(M,X));for(let M=0;M<S;M+=1){const[X,re]=b[M];v(X),v(re)}}if(E>A){const S=b.length;if(S>1)T(S);else{const M=s.slice(k,u);u=N,C(5,A),v(M)}}else{const S=b.length;S>1&&T(S)}}function be(w){let b=0;if(0<=w&&w<=Et)b=0;else if(-Et<=w&&w<0)b=1,w=-(w+1n);else throw new Error("CBORError: Encountered unsafe integer outside of valid CBOR range.");if(w<0x100000000n)return C(b,Number(w));p(b<<5|27),oe(w)}function j(w){if(w!==Se){if(w===!1)return p(244);if(w===!0)return p(245);if(w===null)return p(246);if(w===void 0)return p(247);if(Gn(w,-0))return v([249,128,0]);switch(typeof w){case"bigint":return be(w);case"number":if(Math.floor(w)===w){if(0<=w&&w<=Qe)return C(0,w);if(-Qe<=w&&w<0)return C(1,-(w+1))}return p(251),f(w);case"string":{const b=[],N=w.length;for(let k=0;k<N;++k){let E=w.charCodeAt(k);E<128?b.push(E):E<2048?(b.push(192|E>>6),b.push(128|E&63)):E<55296||E>=57344?(b.push(224|E>>12),b.push(128|E>>6&63),b.push(128|E&63)):(E=(E&1023)<<10,E|=w.charCodeAt(++k)&1023,E+=65536,b.push(240|E>>18),b.push(128|E>>12&63),b.push(128|E>>6&63),b.push(128|E&63))}return C(3,b.length),v(b)}default:{let b;if(Array.isArray(w))we(w);else if(w instanceof Uint8Array)Y(Pt,he<<5),C(2,w.length),v(w);else if(w instanceof Int8Array)Y(Jt,he<<5),C(2,w.byteLength),v(new Uint8Array(w.buffer));else if(w instanceof Uint16Array)Y(jt,he<<5),C(2,w.byteLength),v(new Uint8Array(w.buffer));else if(w instanceof Int16Array)Y(Wt,he<<5),C(2,w.byteLength),v(new Uint8Array(w.buffer));else if(w instanceof Uint32Array)Y(Gt,he<<5),C(2,w.byteLength),v(new Uint8Array(w.buffer));else if(w instanceof Int32Array)Y(qt,he<<5),C(2,w.byteLength),v(new Uint8Array(w.buffer));else if(w instanceof Float32Array)Y(Yt,he<<5),C(2,w.byteLength),v(new Uint8Array(w.buffer));else if(w instanceof Float64Array)Y(Kt,he<<5),C(2,w.byteLength),v(new Uint8Array(w.buffer));else if(ArrayBuffer.isView(w))b=new Uint8Array(w.buffer),C(2,b.length),v(b);else if(w instanceof ArrayBuffer||typeof SharedArrayBuffer=="function"&&w instanceof SharedArrayBuffer)b=new Uint8Array(w),C(2,b.length),v(b);else if(w instanceof Xt)Y(w.tag,192),j(w.value);else if(w instanceof de)C(7,w.value);else if(w instanceof et){if(u!==0)throw new Error("CBORError: A CBOR Sequence may not be nested.");const N=w.size;for(let k=0;k<N;k+=1)j(w.get(k))}else ae(w)}}}}if(j(g(L,o)),"slice"in t)return t.slice(0,u);const G=new ArrayBuffer(u),K=new DataView(G);for(let w=0;w<u;++w)K.setUint8(w,i.getUint8(w));return G}function Yn(o,e){return Zt(o,e)}const Qt={binarify:Yn,decode:zt,encode:Zt,parse:qn};var er={},Pe={};Pe.byteLength=zn;Pe.toByteArray=Qn;Pe.fromByteArray=ri;var se=[],ee=[],Kn=typeof Uint8Array<"u"?Uint8Array:Array,Xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ee=0,Xn=Xe.length;Ee<Xn;++Ee)se[Ee]=Xe[Ee],ee[Xe.charCodeAt(Ee)]=Ee;ee[45]=62;ee[95]=63;function tr(o){var e=o.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=o.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function zn(o){var e=tr(o),t=e[0],i=e[1];return(t+i)*3/4-i}function Zn(o,e,t){return(e+t)*3/4-t}function Qn(o){var e,t=tr(o),i=t[0],s=t[1],l=new Kn(Zn(o,i,s)),u=0,g=s>0?i-4:i,d;for(d=0;d<g;d+=4)e=ee[o.charCodeAt(d)]<<18|ee[o.charCodeAt(d+1)]<<12|ee[o.charCodeAt(d+2)]<<6|ee[o.charCodeAt(d+3)],l[u++]=e>>16&255,l[u++]=e>>8&255,l[u++]=e&255;return s===2&&(e=ee[o.charCodeAt(d)]<<2|ee[o.charCodeAt(d+1)]>>4,l[u++]=e&255),s===1&&(e=ee[o.charCodeAt(d)]<<10|ee[o.charCodeAt(d+1)]<<4|ee[o.charCodeAt(d+2)]>>2,l[u++]=e>>8&255,l[u++]=e&255),l}function ei(o){return se[o>>18&63]+se[o>>12&63]+se[o>>6&63]+se[o&63]}function ti(o,e,t){for(var i,s=[],l=e;l<t;l+=3)i=(o[l]<<16&16711680)+(o[l+1]<<8&65280)+(o[l+2]&255),s.push(ei(i));return s.join("")}function ri(o){for(var e,t=o.length,i=t%3,s=[],l=16383,u=0,g=t-i;u<g;u+=l)s.push(ti(o,u,u+l>g?g:u+l));return i===1?(e=o[t-1],s.push(se[e>>2]+se[e<<4&63]+"==")):i===2&&(e=(o[t-2]<<8)+o[t-1],s.push(se[e>>10]+se[e>>4&63]+se[e<<2&63]+"=")),s.join("")}var st={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */st.read=function(o,e,t,i,s){var l,u,g=s*8-i-1,d=(1<<g)-1,B=d>>1,f=-7,p=t?s-1:0,v=t?-1:1,I=o[e+p];for(p+=v,l=I&(1<<-f)-1,I>>=-f,f+=g;f>0;l=l*256+o[e+p],p+=v,f-=8);for(u=l&(1<<-f)-1,l>>=-f,f+=i;f>0;u=u*256+o[e+p],p+=v,f-=8);if(l===0)l=1-B;else{if(l===d)return u?NaN:(I?-1:1)*(1/0);u=u+Math.pow(2,i),l=l-B}return(I?-1:1)*u*Math.pow(2,l-i)};st.write=function(o,e,t,i,s,l){var u,g,d,B=l*8-s-1,f=(1<<B)-1,p=f>>1,v=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=i?0:l-1,D=i?1:-1,P=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(g=isNaN(e)?1:0,u=f):(u=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-u))<1&&(u--,d*=2),u+p>=1?e+=v/d:e+=v*Math.pow(2,1-p),e*d>=2&&(u++,d/=2),u+p>=f?(g=0,u=f):u+p>=1?(g=(e*d-1)*Math.pow(2,s),u=u+p):(g=e*Math.pow(2,p-1)*Math.pow(2,s),u=0));s>=8;o[t+I]=g&255,I+=D,g/=256,s-=8);for(u=u<<s|g,B+=s;B>0;o[t+I]=u&255,I+=D,u/=256,B-=8);o[t+I-D]|=P*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(o){const e=Pe,t=st,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;o.Buffer=f,o.SlowBuffer=be,o.INSPECT_MAX_BYTES=50;const s=2147483647;o.kMaxLength=s;const{Uint8Array:l,ArrayBuffer:u,SharedArrayBuffer:g}=globalThis;f.TYPED_ARRAY_SUPPORT=d(),!f.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function d(){try{const c=new l(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,l.prototype),Object.setPrototypeOf(c,r),c.foo()===42}catch{return!1}}Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}});function B(c){if(c>s)throw new RangeError('The value "'+c+'" is invalid for option "size"');const r=new l(c);return Object.setPrototypeOf(r,f.prototype),r}function f(c,r,n){if(typeof c=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return D(c)}return p(c,r,n)}f.poolSize=8192;function p(c,r,n){if(typeof c=="string")return P(c,r);if(u.isView(c))return Y(c);if(c==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(ne(c,u)||c&&ne(c.buffer,u)||typeof g<"u"&&(ne(c,g)||c&&ne(c.buffer,g)))return C(c,r,n);if(typeof c=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const a=c.valueOf&&c.valueOf();if(a!=null&&a!==c)return f.from(a,r,n);const h=we(c);if(h)return h;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof c[Symbol.toPrimitive]=="function")return f.from(c[Symbol.toPrimitive]("string"),r,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}f.from=function(c,r,n){return p(c,r,n)},Object.setPrototypeOf(f.prototype,l.prototype),Object.setPrototypeOf(f,l);function v(c){if(typeof c!="number")throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}function I(c,r,n){return v(c),c<=0?B(c):r!==void 0?typeof n=="string"?B(c).fill(r,n):B(c).fill(r):B(c)}f.alloc=function(c,r,n){return I(c,r,n)};function D(c){return v(c),B(c<0?0:ae(c)|0)}f.allocUnsafe=function(c){return D(c)},f.allocUnsafeSlow=function(c){return D(c)};function P(c,r){if((typeof r!="string"||r==="")&&(r="utf8"),!f.isEncoding(r))throw new TypeError("Unknown encoding: "+r);const n=j(c,r)|0;let a=B(n);const h=a.write(c,r);return h!==n&&(a=a.slice(0,h)),a}function oe(c){const r=c.length<0?0:ae(c.length)|0,n=B(r);for(let a=0;a<r;a+=1)n[a]=c[a]&255;return n}function Y(c){if(ne(c,l)){const r=new l(c);return C(r.buffer,r.byteOffset,r.byteLength)}return oe(c)}function C(c,r,n){if(r<0||c.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<r+(n||0))throw new RangeError('"length" is outside of buffer bounds');let a;return r===void 0&&n===void 0?a=new l(c):n===void 0?a=new l(c,r):a=new l(c,r,n),Object.setPrototypeOf(a,f.prototype),a}function we(c){if(f.isBuffer(c)){const r=ae(c.length)|0,n=B(r);return n.length===0||c.copy(n,0,0,r),n}if(c.length!==void 0)return typeof c.length!="number"||qe(c.length)?B(0):oe(c);if(c.type==="Buffer"&&Array.isArray(c.data))return oe(c.data)}function ae(c){if(c>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return c|0}function be(c){return+c!=c&&(c=0),f.alloc(+c)}f.isBuffer=function(r){return r!=null&&r._isBuffer===!0&&r!==f.prototype},f.compare=function(r,n){if(ne(r,l)&&(r=f.from(r,r.offset,r.byteLength)),ne(n,l)&&(n=f.from(n,n.offset,n.byteLength)),!f.isBuffer(r)||!f.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===n)return 0;let a=r.length,h=n.length;for(let y=0,x=Math.min(a,h);y<x;++y)if(r[y]!==n[y]){a=r[y],h=n[y];break}return a<h?-1:h<a?1:0},f.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(r,n){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return f.alloc(0);let a;if(n===void 0)for(n=0,a=0;a<r.length;++a)n+=r[a].length;const h=f.allocUnsafe(n);let y=0;for(a=0;a<r.length;++a){let x=r[a];if(ne(x,l))y+x.length>h.length?(f.isBuffer(x)||(x=f.from(x)),x.copy(h,y)):l.prototype.set.call(h,x,y);else if(f.isBuffer(x))x.copy(h,y);else throw new TypeError('"list" argument must be an Array of Buffers');y+=x.length}return h};function j(c,r){if(f.isBuffer(c))return c.length;if(u.isView(c)||ne(c,u))return c.byteLength;if(typeof c!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);const n=c.length,a=arguments.length>2&&arguments[2]===!0;if(!a&&n===0)return 0;let h=!1;for(;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return We(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n*2;case"hex":return n>>>1;case"base64":return mt(c).length;default:if(h)return a?-1:We(c).length;r=(""+r).toLowerCase(),h=!0}}f.byteLength=j;function G(c,r,n){let a=!1;if((r===void 0||r<0)&&(r=0),r>this.length||((n===void 0||n>this.length)&&(n=this.length),n<=0)||(n>>>=0,r>>>=0,n<=r))return"";for(c||(c="utf8");;)switch(c){case"hex":return Ge(this,r,n);case"utf8":case"utf-8":return M(this,r,n);case"ascii":return ye(this,r,n);case"latin1":case"binary":return Ie(this,r,n);case"base64":return S(this,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return On(this,r,n);default:if(a)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),a=!0}}f.prototype._isBuffer=!0;function K(c,r,n){const a=c[r];c[r]=c[n],c[n]=a}f.prototype.swap16=function(){const r=this.length;if(r%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<r;n+=2)K(this,n,n+1);return this},f.prototype.swap32=function(){const r=this.length;if(r%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<r;n+=4)K(this,n,n+3),K(this,n+1,n+2);return this},f.prototype.swap64=function(){const r=this.length;if(r%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<r;n+=8)K(this,n,n+7),K(this,n+1,n+6),K(this,n+2,n+5),K(this,n+3,n+4);return this},f.prototype.toString=function(){const r=this.length;return r===0?"":arguments.length===0?M(this,0,r):G.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(r){if(!f.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r?!0:f.compare(this,r)===0},f.prototype.inspect=function(){let r="";const n=o.INSPECT_MAX_BYTES;return r=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(r+=" ... "),"<Buffer "+r+">"},i&&(f.prototype[i]=f.prototype.inspect),f.prototype.compare=function(r,n,a,h,y){if(ne(r,l)&&(r=f.from(r,r.offset,r.byteLength)),!f.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(n===void 0&&(n=0),a===void 0&&(a=r?r.length:0),h===void 0&&(h=0),y===void 0&&(y=this.length),n<0||a>r.length||h<0||y>this.length)throw new RangeError("out of range index");if(h>=y&&n>=a)return 0;if(h>=y)return-1;if(n>=a)return 1;if(n>>>=0,a>>>=0,h>>>=0,y>>>=0,this===r)return 0;let x=y-h,U=a-n;const R=Math.min(x,U),O=this.slice(h,y),_=r.slice(n,a);for(let F=0;F<R;++F)if(O[F]!==_[F]){x=O[F],U=_[F];break}return x<U?-1:U<x?1:0};function w(c,r,n,a,h){if(c.length===0)return-1;if(typeof n=="string"?(a=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,qe(n)&&(n=h?0:c.length-1),n<0&&(n=c.length+n),n>=c.length){if(h)return-1;n=c.length-1}else if(n<0)if(h)n=0;else return-1;if(typeof r=="string"&&(r=f.from(r,a)),f.isBuffer(r))return r.length===0?-1:b(c,r,n,a,h);if(typeof r=="number")return r=r&255,typeof l.prototype.indexOf=="function"?h?l.prototype.indexOf.call(c,r,n):l.prototype.lastIndexOf.call(c,r,n):b(c,[r],n,a,h);throw new TypeError("val must be string, number or Buffer")}function b(c,r,n,a,h){let y=1,x=c.length,U=r.length;if(a!==void 0&&(a=String(a).toLowerCase(),a==="ucs2"||a==="ucs-2"||a==="utf16le"||a==="utf-16le")){if(c.length<2||r.length<2)return-1;y=2,x/=2,U/=2,n/=2}function R(_,F){return y===1?_[F]:_.readUInt16BE(F*y)}let O;if(h){let _=-1;for(O=n;O<x;O++)if(R(c,O)===R(r,_===-1?0:O-_)){if(_===-1&&(_=O),O-_+1===U)return _*y}else _!==-1&&(O-=O-_),_=-1}else for(n+U>x&&(n=x-U),O=n;O>=0;O--){let _=!0;for(let F=0;F<U;F++)if(R(c,O+F)!==R(r,F)){_=!1;break}if(_)return O}return-1}f.prototype.includes=function(r,n,a){return this.indexOf(r,n,a)!==-1},f.prototype.indexOf=function(r,n,a){return w(this,r,n,a,!0)},f.prototype.lastIndexOf=function(r,n,a){return w(this,r,n,a,!1)};function N(c,r,n,a){n=Number(n)||0;const h=c.length-n;a?(a=Number(a),a>h&&(a=h)):a=h;const y=r.length;a>y/2&&(a=y/2);let x;for(x=0;x<a;++x){const U=parseInt(r.substr(x*2,2),16);if(qe(U))return x;c[n+x]=U}return x}function k(c,r,n,a){return _e(We(r,c.length-n),c,n,a)}function E(c,r,n,a){return _e(Mn(r),c,n,a)}function A(c,r,n,a){return _e(mt(r),c,n,a)}function T(c,r,n,a){return _e(Dn(r,c.length-n),c,n,a)}f.prototype.write=function(r,n,a,h){if(n===void 0)h="utf8",a=this.length,n=0;else if(a===void 0&&typeof n=="string")h=n,a=this.length,n=0;else if(isFinite(n))n=n>>>0,isFinite(a)?(a=a>>>0,h===void 0&&(h="utf8")):(h=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const y=this.length-n;if((a===void 0||a>y)&&(a=y),r.length>0&&(a<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");h||(h="utf8");let x=!1;for(;;)switch(h){case"hex":return N(this,r,n,a);case"utf8":case"utf-8":return k(this,r,n,a);case"ascii":case"latin1":case"binary":return E(this,r,n,a);case"base64":return A(this,r,n,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,r,n,a);default:if(x)throw new TypeError("Unknown encoding: "+h);h=(""+h).toLowerCase(),x=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function S(c,r,n){return r===0&&n===c.length?e.fromByteArray(c):e.fromByteArray(c.slice(r,n))}function M(c,r,n){n=Math.min(c.length,n);const a=[];let h=r;for(;h<n;){const y=c[h];let x=null,U=y>239?4:y>223?3:y>191?2:1;if(h+U<=n){let R,O,_,F;switch(U){case 1:y<128&&(x=y);break;case 2:R=c[h+1],(R&192)===128&&(F=(y&31)<<6|R&63,F>127&&(x=F));break;case 3:R=c[h+1],O=c[h+2],(R&192)===128&&(O&192)===128&&(F=(y&15)<<12|(R&63)<<6|O&63,F>2047&&(F<55296||F>57343)&&(x=F));break;case 4:R=c[h+1],O=c[h+2],_=c[h+3],(R&192)===128&&(O&192)===128&&(_&192)===128&&(F=(y&15)<<18|(R&63)<<12|(O&63)<<6|_&63,F>65535&&F<1114112&&(x=F))}}x===null?(x=65533,U=1):x>65535&&(x-=65536,a.push(x>>>10&1023|55296),x=56320|x&1023),a.push(x),h+=U}return re(a)}const X=4096;function re(c){const r=c.length;if(r<=X)return String.fromCharCode.apply(String,c);let n="",a=0;for(;a<r;)n+=String.fromCharCode.apply(String,c.slice(a,a+=X));return n}function ye(c,r,n){let a="";n=Math.min(c.length,n);for(let h=r;h<n;++h)a+=String.fromCharCode(c[h]&127);return a}function Ie(c,r,n){let a="";n=Math.min(c.length,n);for(let h=r;h<n;++h)a+=String.fromCharCode(c[h]);return a}function Ge(c,r,n){const a=c.length;(!r||r<0)&&(r=0),(!n||n<0||n>a)&&(n=a);let h="";for(let y=r;y<n;++y)h+=$n[c[y]];return h}function On(c,r,n){const a=c.slice(r,n);let h="";for(let y=0;y<a.length-1;y+=2)h+=String.fromCharCode(a[y]+a[y+1]*256);return h}f.prototype.slice=function(r,n){const a=this.length;r=~~r,n=n===void 0?a:~~n,r<0?(r+=a,r<0&&(r=0)):r>a&&(r=a),n<0?(n+=a,n<0&&(n=0)):n>a&&(n=a),n<r&&(n=r);const h=this.subarray(r,n);return Object.setPrototypeOf(h,f.prototype),h};function $(c,r,n){if(c%1!==0||c<0)throw new RangeError("offset is not uint");if(c+r>n)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUintLE=f.prototype.readUIntLE=function(r,n,a){r=r>>>0,n=n>>>0,a||$(r,n,this.length);let h=this[r],y=1,x=0;for(;++x<n&&(y*=256);)h+=this[r+x]*y;return h},f.prototype.readUintBE=f.prototype.readUIntBE=function(r,n,a){r=r>>>0,n=n>>>0,a||$(r,n,this.length);let h=this[r+--n],y=1;for(;n>0&&(y*=256);)h+=this[r+--n]*y;return h},f.prototype.readUint8=f.prototype.readUInt8=function(r,n){return r=r>>>0,n||$(r,1,this.length),this[r]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(r,n){return r=r>>>0,n||$(r,2,this.length),this[r]|this[r+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(r,n){return r=r>>>0,n||$(r,2,this.length),this[r]<<8|this[r+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(r,n){return r=r>>>0,n||$(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+this[r+3]*16777216},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(r,n){return r=r>>>0,n||$(r,4,this.length),this[r]*16777216+(this[r+1]<<16|this[r+2]<<8|this[r+3])},f.prototype.readBigUInt64LE=fe(function(r){r=r>>>0,ke(r,"offset");const n=this[r],a=this[r+7];(n===void 0||a===void 0)&&Ne(r,this.length-8);const h=n+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24,y=this[++r]+this[++r]*2**8+this[++r]*2**16+a*2**24;return BigInt(h)+(BigInt(y)<<BigInt(32))}),f.prototype.readBigUInt64BE=fe(function(r){r=r>>>0,ke(r,"offset");const n=this[r],a=this[r+7];(n===void 0||a===void 0)&&Ne(r,this.length-8);const h=n*2**24+this[++r]*2**16+this[++r]*2**8+this[++r],y=this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+a;return(BigInt(h)<<BigInt(32))+BigInt(y)}),f.prototype.readIntLE=function(r,n,a){r=r>>>0,n=n>>>0,a||$(r,n,this.length);let h=this[r],y=1,x=0;for(;++x<n&&(y*=256);)h+=this[r+x]*y;return y*=128,h>=y&&(h-=Math.pow(2,8*n)),h},f.prototype.readIntBE=function(r,n,a){r=r>>>0,n=n>>>0,a||$(r,n,this.length);let h=n,y=1,x=this[r+--h];for(;h>0&&(y*=256);)x+=this[r+--h]*y;return y*=128,x>=y&&(x-=Math.pow(2,8*n)),x},f.prototype.readInt8=function(r,n){return r=r>>>0,n||$(r,1,this.length),this[r]&128?(255-this[r]+1)*-1:this[r]},f.prototype.readInt16LE=function(r,n){r=r>>>0,n||$(r,2,this.length);const a=this[r]|this[r+1]<<8;return a&32768?a|4294901760:a},f.prototype.readInt16BE=function(r,n){r=r>>>0,n||$(r,2,this.length);const a=this[r+1]|this[r]<<8;return a&32768?a|4294901760:a},f.prototype.readInt32LE=function(r,n){return r=r>>>0,n||$(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},f.prototype.readInt32BE=function(r,n){return r=r>>>0,n||$(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},f.prototype.readBigInt64LE=fe(function(r){r=r>>>0,ke(r,"offset");const n=this[r],a=this[r+7];(n===void 0||a===void 0)&&Ne(r,this.length-8);const h=this[r+4]+this[r+5]*2**8+this[r+6]*2**16+(a<<24);return(BigInt(h)<<BigInt(32))+BigInt(n+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24)}),f.prototype.readBigInt64BE=fe(function(r){r=r>>>0,ke(r,"offset");const n=this[r],a=this[r+7];(n===void 0||a===void 0)&&Ne(r,this.length-8);const h=(n<<24)+this[++r]*2**16+this[++r]*2**8+this[++r];return(BigInt(h)<<BigInt(32))+BigInt(this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+a)}),f.prototype.readFloatLE=function(r,n){return r=r>>>0,n||$(r,4,this.length),t.read(this,r,!0,23,4)},f.prototype.readFloatBE=function(r,n){return r=r>>>0,n||$(r,4,this.length),t.read(this,r,!1,23,4)},f.prototype.readDoubleLE=function(r,n){return r=r>>>0,n||$(r,8,this.length),t.read(this,r,!0,52,8)},f.prototype.readDoubleBE=function(r,n){return r=r>>>0,n||$(r,8,this.length),t.read(this,r,!1,52,8)};function J(c,r,n,a,h,y){if(!f.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>h||r<y)throw new RangeError('"value" argument is out of bounds');if(n+a>c.length)throw new RangeError("Index out of range")}f.prototype.writeUintLE=f.prototype.writeUIntLE=function(r,n,a,h){if(r=+r,n=n>>>0,a=a>>>0,!h){const U=Math.pow(2,8*a)-1;J(this,r,n,a,U,0)}let y=1,x=0;for(this[n]=r&255;++x<a&&(y*=256);)this[n+x]=r/y&255;return n+a},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(r,n,a,h){if(r=+r,n=n>>>0,a=a>>>0,!h){const U=Math.pow(2,8*a)-1;J(this,r,n,a,U,0)}let y=a-1,x=1;for(this[n+y]=r&255;--y>=0&&(x*=256);)this[n+y]=r/x&255;return n+a},f.prototype.writeUint8=f.prototype.writeUInt8=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,1,255,0),this[n]=r&255,n+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,2,65535,0),this[n]=r&255,this[n+1]=r>>>8,n+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,2,65535,0),this[n]=r>>>8,this[n+1]=r&255,n+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,4,4294967295,0),this[n+3]=r>>>24,this[n+2]=r>>>16,this[n+1]=r>>>8,this[n]=r&255,n+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,4,4294967295,0),this[n]=r>>>24,this[n+1]=r>>>16,this[n+2]=r>>>8,this[n+3]=r&255,n+4};function gt(c,r,n,a,h){bt(r,a,h,c,n,7);let y=Number(r&BigInt(4294967295));c[n++]=y,y=y>>8,c[n++]=y,y=y>>8,c[n++]=y,y=y>>8,c[n++]=y;let x=Number(r>>BigInt(32)&BigInt(4294967295));return c[n++]=x,x=x>>8,c[n++]=x,x=x>>8,c[n++]=x,x=x>>8,c[n++]=x,n}function wt(c,r,n,a,h){bt(r,a,h,c,n,7);let y=Number(r&BigInt(4294967295));c[n+7]=y,y=y>>8,c[n+6]=y,y=y>>8,c[n+5]=y,y=y>>8,c[n+4]=y;let x=Number(r>>BigInt(32)&BigInt(4294967295));return c[n+3]=x,x=x>>8,c[n+2]=x,x=x>>8,c[n+1]=x,x=x>>8,c[n]=x,n+8}f.prototype.writeBigUInt64LE=fe(function(r,n=0){return gt(this,r,n,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeBigUInt64BE=fe(function(r,n=0){return wt(this,r,n,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeIntLE=function(r,n,a,h){if(r=+r,n=n>>>0,!h){const R=Math.pow(2,8*a-1);J(this,r,n,a,R-1,-R)}let y=0,x=1,U=0;for(this[n]=r&255;++y<a&&(x*=256);)r<0&&U===0&&this[n+y-1]!==0&&(U=1),this[n+y]=(r/x>>0)-U&255;return n+a},f.prototype.writeIntBE=function(r,n,a,h){if(r=+r,n=n>>>0,!h){const R=Math.pow(2,8*a-1);J(this,r,n,a,R-1,-R)}let y=a-1,x=1,U=0;for(this[n+y]=r&255;--y>=0&&(x*=256);)r<0&&U===0&&this[n+y+1]!==0&&(U=1),this[n+y]=(r/x>>0)-U&255;return n+a},f.prototype.writeInt8=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,1,127,-128),r<0&&(r=255+r+1),this[n]=r&255,n+1},f.prototype.writeInt16LE=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,2,32767,-32768),this[n]=r&255,this[n+1]=r>>>8,n+2},f.prototype.writeInt16BE=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,2,32767,-32768),this[n]=r>>>8,this[n+1]=r&255,n+2},f.prototype.writeInt32LE=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,4,2147483647,-2147483648),this[n]=r&255,this[n+1]=r>>>8,this[n+2]=r>>>16,this[n+3]=r>>>24,n+4},f.prototype.writeInt32BE=function(r,n,a){return r=+r,n=n>>>0,a||J(this,r,n,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[n]=r>>>24,this[n+1]=r>>>16,this[n+2]=r>>>8,this[n+3]=r&255,n+4},f.prototype.writeBigInt64LE=fe(function(r,n=0){return gt(this,r,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),f.prototype.writeBigInt64BE=fe(function(r,n=0){return wt(this,r,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function yt(c,r,n,a,h,y){if(n+a>c.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Bt(c,r,n,a,h){return r=+r,n=n>>>0,h||yt(c,r,n,4),t.write(c,r,n,a,23,4),n+4}f.prototype.writeFloatLE=function(r,n,a){return Bt(this,r,n,!0,a)},f.prototype.writeFloatBE=function(r,n,a){return Bt(this,r,n,!1,a)};function xt(c,r,n,a,h){return r=+r,n=n>>>0,h||yt(c,r,n,8),t.write(c,r,n,a,52,8),n+8}f.prototype.writeDoubleLE=function(r,n,a){return xt(this,r,n,!0,a)},f.prototype.writeDoubleBE=function(r,n,a){return xt(this,r,n,!1,a)},f.prototype.copy=function(r,n,a,h){if(!f.isBuffer(r))throw new TypeError("argument should be a Buffer");if(a||(a=0),!h&&h!==0&&(h=this.length),n>=r.length&&(n=r.length),n||(n=0),h>0&&h<a&&(h=a),h===a||r.length===0||this.length===0)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("Index out of range");if(h<0)throw new RangeError("sourceEnd out of bounds");h>this.length&&(h=this.length),r.length-n<h-a&&(h=r.length-n+a);const y=h-a;return this===r&&typeof l.prototype.copyWithin=="function"?this.copyWithin(n,a,h):l.prototype.set.call(r,this.subarray(a,h),n),y},f.prototype.fill=function(r,n,a,h){if(typeof r=="string"){if(typeof n=="string"?(h=n,n=0,a=this.length):typeof a=="string"&&(h=a,a=this.length),h!==void 0&&typeof h!="string")throw new TypeError("encoding must be a string");if(typeof h=="string"&&!f.isEncoding(h))throw new TypeError("Unknown encoding: "+h);if(r.length===1){const x=r.charCodeAt(0);(h==="utf8"&&x<128||h==="latin1")&&(r=x)}}else typeof r=="number"?r=r&255:typeof r=="boolean"&&(r=Number(r));if(n<0||this.length<n||this.length<a)throw new RangeError("Out of range index");if(a<=n)return this;n=n>>>0,a=a===void 0?this.length:a>>>0,r||(r=0);let y;if(typeof r=="number")for(y=n;y<a;++y)this[y]=r;else{const x=f.isBuffer(r)?r:f.from(r,h),U=x.length;if(U===0)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(y=0;y<a-n;++y)this[y+n]=x[y%U]}return this};const me={};function Je(c,r,n){me[c]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:r.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${c}]`,this.stack,delete this.name}get code(){return c}set code(h){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:h,writable:!0})}toString(){return`${this.name} [${c}]: ${this.message}`}}}Je("ERR_BUFFER_OUT_OF_BOUNDS",function(c){return c?`${c} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Je("ERR_INVALID_ARG_TYPE",function(c,r){return`The "${c}" argument must be of type number. Received type ${typeof r}`},TypeError),Je("ERR_OUT_OF_RANGE",function(c,r,n){let a=`The value of "${c}" is out of range.`,h=n;return Number.isInteger(n)&&Math.abs(n)>2**32?h=pt(String(n)):typeof n=="bigint"&&(h=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(h=pt(h)),h+="n"),a+=` It must be ${r}. Received ${h}`,a},RangeError);function pt(c){let r="",n=c.length;const a=c[0]==="-"?1:0;for(;n>=a+4;n-=3)r=`_${c.slice(n-3,n)}${r}`;return`${c.slice(0,n)}${r}`}function Rn(c,r,n){ke(r,"offset"),(c[r]===void 0||c[r+n]===void 0)&&Ne(r,c.length-(n+1))}function bt(c,r,n,a,h,y){if(c>n||c<r){const x=typeof r=="bigint"?"n":"";let U;throw r===0||r===BigInt(0)?U=`>= 0${x} and < 2${x} ** ${(y+1)*8}${x}`:U=`>= -(2${x} ** ${(y+1)*8-1}${x}) and < 2 ** ${(y+1)*8-1}${x}`,new me.ERR_OUT_OF_RANGE("value",U,c)}Rn(a,h,y)}function ke(c,r){if(typeof c!="number")throw new me.ERR_INVALID_ARG_TYPE(r,"number",c)}function Ne(c,r,n){throw Math.floor(c)!==c?(ke(c,n),new me.ERR_OUT_OF_RANGE("offset","an integer",c)):r<0?new me.ERR_BUFFER_OUT_OF_BOUNDS:new me.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${r}`,c)}const _n=/[^+/0-9A-Za-z-_]/g;function Hn(c){if(c=c.split("=")[0],c=c.trim().replace(_n,""),c.length<2)return"";for(;c.length%4!==0;)c=c+"=";return c}function We(c,r){r=r||1/0;let n;const a=c.length;let h=null;const y=[];for(let x=0;x<a;++x){if(n=c.charCodeAt(x),n>55295&&n<57344){if(!h){if(n>56319){(r-=3)>-1&&y.push(239,191,189);continue}else if(x+1===a){(r-=3)>-1&&y.push(239,191,189);continue}h=n;continue}if(n<56320){(r-=3)>-1&&y.push(239,191,189),h=n;continue}n=(h-55296<<10|n-56320)+65536}else h&&(r-=3)>-1&&y.push(239,191,189);if(h=null,n<128){if((r-=1)<0)break;y.push(n)}else if(n<2048){if((r-=2)<0)break;y.push(n>>6|192,n&63|128)}else if(n<65536){if((r-=3)<0)break;y.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((r-=4)<0)break;y.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return y}function Mn(c){const r=[];for(let n=0;n<c.length;++n)r.push(c.charCodeAt(n)&255);return r}function Dn(c,r){let n,a,h;const y=[];for(let x=0;x<c.length&&!((r-=2)<0);++x)n=c.charCodeAt(x),a=n>>8,h=n%256,y.push(h),y.push(a);return y}function mt(c){return e.toByteArray(Hn(c))}function _e(c,r,n,a){let h;for(h=0;h<a&&!(h+n>=r.length||h>=c.length);++h)r[h+n]=c[h];return h}function ne(c,r){return c instanceof r||c!=null&&c.constructor!=null&&c.constructor.name!=null&&c.constructor.name===r.name}function qe(c){return c!==c}const $n=function(){const c="0123456789abcdef",r=new Array(256);for(let n=0;n<16;++n){const a=n*16;for(let h=0;h<16;++h)r[a+h]=c[n]+c[h]}return r}();function fe(c){return typeof BigInt>"u"?Pn:c}function Pn(){throw new Error("BigInt not supported")}})(er);const Ut=er.Buffer;/*!
 * MIT License
 * 
 * Copyright (c) 2017-2022 Peculiar Ventures, LLC
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const ni="[object ArrayBuffer]";class V{static isArrayBuffer(e){return Object.prototype.toString.call(e)===ni}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const i=V.toUint8Array(e),s=V.toUint8Array(t);if(i.length!==s.byteLength)return!1;for(let l=0;l<i.length;l++)if(i[l]!==s[l])return!1;return!0}static concat(...e){let t;Array.isArray(e[0])&&!(e[1]instanceof Function)||Array.isArray(e[0])&&e[1]instanceof Function?t=e[0]:e[e.length-1]instanceof Function?t=e.slice(0,e.length-1):t=e;let i=0;for(const u of t)i+=u.byteLength;const s=new Uint8Array(i);let l=0;for(const u of t){const g=this.toUint8Array(u);s.set(g,l),l+=g.length}return e[e.length-1]instanceof Function?this.toView(s,e[e.length-1]):s.buffer}}const ze="string",ii=/^[0-9a-f]+$/i,si=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,oi=/^[a-zA-Z0-9-_]+$/;class It{static fromString(e){const t=unescape(encodeURIComponent(e)),i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i.buffer}static toString(e){const t=V.toUint8Array(e);let i="";for(let l=0;l<t.length;l++)i+=String.fromCharCode(t[l]);return decodeURIComponent(escape(i))}}class ie{static toString(e,t=!1){const i=V.toArrayBuffer(e),s=new DataView(i);let l="";for(let u=0;u<i.byteLength;u+=2){const g=s.getUint16(u,t);l+=String.fromCharCode(g)}return l}static fromString(e,t=!1){const i=new ArrayBuffer(e.length*2),s=new DataView(i);for(let l=0;l<e.length;l++)s.setUint16(l*2,e.charCodeAt(l),t);return i}}class H{static isHex(e){return typeof e===ze&&ii.test(e)}static isBase64(e){return typeof e===ze&&si.test(e)}static isBase64Url(e){return typeof e===ze&&oi.test(e)}static ToString(e,t="utf8"){const i=V.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(i);case"binary":return this.ToBinary(i);case"hex":return this.ToHex(i);case"base64":return this.ToBase64(i);case"base64url":return this.ToBase64Url(i);case"utf16le":return ie.toString(i,!0);case"utf16":case"utf16be":return ie.toString(i);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return ie.fromString(e,!0);case"utf16":case"utf16be":return ie.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=V.toUint8Array(e);if(typeof btoa<"u"){const i=this.ToString(t,"binary");return btoa(i)}else return Ut.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!H.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(t)):new Uint8Array(Ut.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!H.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=H.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return It.fromString(e);case"utf16":case"utf16be":return ie.fromString(e);case"utf16le":case"usc2":return ie.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=H.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return It.toString(e);case"utf16":case"utf16be":return ie.toString(e);case"utf16le":case"usc2":return ie.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=e.charCodeAt(s);return i.buffer}static ToBinary(e){const t=V.toUint8Array(e);let i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(t[s]);return i}static ToHex(e){const t=V.toUint8Array(e);let i="";const s=t.length;for(let l=0;l<s;l++){const u=t[l];u<16&&(i+="0"),i+=u.toString(16)}return i}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!H.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const i=new Uint8Array(t.length/2);for(let s=0;s<t.length;s=s+2){const l=t.slice(s,s+2);i[s/2]=parseInt(l,16)}return i.buffer}static ToUtf16String(e,t=!1){return ie.toString(e,t)}static FromUtf16String(e,t=!1){return ie.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let i=0;i<t;i++)e+="=";return e}static formatString(e){return(e==null?void 0:e.replace(/[\n\r\t ]/g,""))||""}}H.DEFAULT_UTF8_ENCODING="utf8";/*!
 Copyright (c) Peculiar Ventures, LLC
*/function ve(o,e){let t=0;if(o.length===1)return o[0];for(let i=o.length-1;i>=0;i--)t+=o[o.length-1-i]*Math.pow(2,e*i);return t}function Be(o,e,t=-1){const i=t;let s=o,l=0,u=Math.pow(2,e);for(let g=1;g<8;g++){if(o<u){let d;if(i<0)d=new ArrayBuffer(g),l=g;else{if(i<g)return new ArrayBuffer(0);d=new ArrayBuffer(i),l=i}const B=new Uint8Array(d);for(let f=g-1;f>=0;f--){const p=Math.pow(2,f*e);B[l-f-1]=Math.floor(s/p),s-=B[l-f-1]*p}return d}u*=Math.pow(2,e)}return new ArrayBuffer(0)}function rt(...o){let e=0,t=0;for(const l of o)e+=l.length;const i=new ArrayBuffer(e),s=new Uint8Array(i);for(const l of o)s.set(l,t),t+=l.length;return s}function rr(){const o=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const g=o[0]===255&&o[1]&128,d=o[0]===0&&(o[1]&128)===0;(g||d)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),t=new Uint8Array(e);for(let g=0;g<this.valueHex.byteLength;g++)t[g]=0;t[0]=o[0]&128;const i=ve(t,8),s=new ArrayBuffer(this.valueHex.byteLength),l=new Uint8Array(s);for(let g=0;g<this.valueHex.byteLength;g++)l[g]=o[g];return l[0]&=127,ve(l,8)-i}function li(o){const e=o<0?o*-1:o;let t=128;for(let i=1;i<8;i++){if(e<=t){if(o<0){const u=t-e,g=Be(u,8,i),d=new Uint8Array(g);return d[0]|=128,g}let s=Be(e,8,i),l=new Uint8Array(s);if(l[0]&128){const u=s.slice(0),g=new Uint8Array(u);s=new ArrayBuffer(s.byteLength+1),l=new Uint8Array(s);for(let d=0;d<u.byteLength;d++)l[d+1]=g[d];l[0]=0}return s}t*=Math.pow(2,8)}return new ArrayBuffer(0)}function ci(o,e){if(o.byteLength!==e.byteLength)return!1;const t=new Uint8Array(o),i=new Uint8Array(e);for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function z(o,e){const t=o.toString(10);if(e<t.length)return"";const i=e-t.length,s=new Array(i);for(let u=0;u<i;u++)s[u]="0";return s.join("").concat(t)}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function De(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function ot(o){let e=0,t=0;for(let s=0;s<o.length;s++){const l=o[s];e+=l.byteLength}const i=new Uint8Array(e);for(let s=0;s<o.length;s++){const l=o[s];i.set(new Uint8Array(l),t),t+=l.byteLength}return i.buffer}function ce(o,e,t,i){return e instanceof Uint8Array?e.byteLength?t<0?(o.error="Wrong parameter: inputOffset less than zero",!1):i<0?(o.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-t-i<0?(o.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(o.error="Wrong parameter: inputBuffer has zero length",!1):(o.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class lt{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return ot(this.items)}}const Ce=[new Uint8Array([1])],Nt="0123456789",Ze="name",St="valueHexView",ui="isHexOnly",ai="idBlock",fi="tagClass",hi="tagNumber",di="isConstructed",gi="fromBER",wi="toBER",yi="local",W="",te=new ArrayBuffer(0),ct=new Uint8Array(0),Le="EndOfContent",nr="OCTET STRING",ir="BIT STRING";function ue(o){var e;return e=class extends o{constructor(...i){var s;super(...i);const l=i[0]||{};this.isHexOnly=(s=l.isHexOnly)!==null&&s!==void 0?s:!1,this.valueHexView=l.valueHex?V.toUint8Array(l.valueHex):ct}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(i){this.valueHexView=new Uint8Array(i)}fromBER(i,s,l){const u=i instanceof ArrayBuffer?new Uint8Array(i):i;if(!ce(this,u,s,l))return-1;const g=s+l;return this.valueHexView=u.subarray(s,g),this.valueHexView.length?(this.blockLength=l,g):(this.warnings.push("Zero buffer length"),s)}toBER(i=!1){return this.isHexOnly?i?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",te)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:H.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}class xe{constructor({blockLength:e=0,error:t=W,warnings:i=[],valueBeforeDecode:s=ct}={}){this.blockLength=e,this.error=t,this.warnings=i,this.valueBeforeDecodeView=V.toUint8Array(s)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:H.ToHex(this.valueBeforeDecodeView)}}}xe.NAME="baseBlock";class Z extends xe{fromBER(e,t,i){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}Z.NAME="valueBlock";class sr extends ue(xe){constructor({idBlock:e={}}={}){var t,i,s,l;super(),e?(this.isHexOnly=(t=e.isHexOnly)!==null&&t!==void 0?t:!1,this.valueHexView=e.valueHex?V.toUint8Array(e.valueHex):ct,this.tagClass=(i=e.tagClass)!==null&&i!==void 0?i:-1,this.tagNumber=(s=e.tagNumber)!==null&&s!==void 0?s:-1,this.isConstructed=(l=e.isConstructed)!==null&&l!==void 0?l:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",te}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const s=new Uint8Array(1);if(!e){let l=this.tagNumber;l&=31,t|=l,s[0]=t}return s.buffer}if(!this.isHexOnly){const s=Be(this.tagNumber,7),l=new Uint8Array(s),u=s.byteLength,g=new Uint8Array(u+1);if(g[0]=t|31,!e){for(let d=0;d<u-1;d++)g[d+1]=l[d]|128;g[u]=l[u-1]}return g.buffer}const i=new Uint8Array(this.valueHexView.byteLength+1);if(i[0]=t|31,!e){const s=this.valueHexView;for(let l=0;l<s.length-1;l++)i[l+1]=s[l]|128;i[this.valueHexView.byteLength]=s[s.length-1]}return i.buffer}fromBER(e,t,i){const s=V.toUint8Array(e);if(!ce(this,s,t,i))return-1;const l=s.subarray(t,t+i);if(l.length===0)return this.error="Zero buffer length",-1;switch(l[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(l[0]&32)===32,this.isHexOnly=!1;const g=l[0]&31;if(g!==31)this.tagNumber=g,this.blockLength=1;else{let d=1,B=this.valueHexView=new Uint8Array(255),f=255;for(;l[d]&128;){if(B[d-1]=l[d]&127,d++,d>=l.length)return this.error="End of input reached before message was fully decoded",-1;if(d===f){f+=255;const v=new Uint8Array(f);for(let I=0;I<B.length;I++)v[I]=B[I];B=this.valueHexView=new Uint8Array(f)}}this.blockLength=d+1,B[d-1]=l[d]&127;const p=new Uint8Array(d);for(let v=0;v<d;v++)p[v]=B[v];B=this.valueHexView=new Uint8Array(d),B.set(p),this.blockLength<=9?this.tagNumber=ve(B,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}sr.NAME="identificationBlock";class or extends xe{constructor({lenBlock:e={}}={}){var t,i,s;super(),this.isIndefiniteForm=(t=e.isIndefiniteForm)!==null&&t!==void 0?t:!1,this.longFormUsed=(i=e.longFormUsed)!==null&&i!==void 0?i:!1,this.length=(s=e.length)!==null&&s!==void 0?s:0}fromBER(e,t,i){const s=V.toUint8Array(e);if(!ce(this,s,t,i))return-1;const l=s.subarray(t,t+i);if(l.length===0)return this.error="Zero buffer length",-1;if(l[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=l[0]===128,this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(l[0]&128),this.longFormUsed===!1)return this.length=l[0],this.blockLength=1,t+this.blockLength;const u=l[0]&127;if(u>8)return this.error="Too big integer",-1;if(u+1>l.length)return this.error="End of input reached before message was fully decoded",-1;const g=t+1,d=s.subarray(g,g+u);return d[u-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=ve(d,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=u+1,t+this.blockLength}toBER(e=!1){let t,i;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),e===!1&&(i=new Uint8Array(t),i[0]=128),t;if(this.longFormUsed){const s=Be(this.length,8);if(s.byteLength>127)return this.error="Too big length",te;if(t=new ArrayBuffer(s.byteLength+1),e)return t;const l=new Uint8Array(s);i=new Uint8Array(t),i[0]=s.byteLength|128;for(let u=0;u<s.byteLength;u++)i[u+1]=l[u];return t}return t=new ArrayBuffer(1),e===!1&&(i=new Uint8Array(t),i[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}or.NAME="lengthBlock";const m={};class q extends xe{constructor({name:e=W,optional:t=!1,primitiveSchema:i,...s}={},l){super(s),this.name=e,this.optional=t,i&&(this.primitiveSchema=i),this.idBlock=new sr(s),this.lenBlock=new or(s),this.valueBlock=l?new l(s):new Z(s)}fromBER(e,t,i){const s=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return s===-1?(this.error=this.valueBlock.error,s):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),s)}toBER(e,t){const i=t||new lt;t||lr(this);const s=this.idBlock.toBER(e);if(i.write(s),this.lenBlock.isIndefiniteForm)i.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,i),i.write(new ArrayBuffer(2));else{const l=this.valueBlock.toBER(e);this.lenBlock.length=l.byteLength;const u=this.lenBlock.toBER(e);i.write(u),i.write(l)}return t?te:i.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return e==="ascii"?this.onAsciiEncoding():H.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${H.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;const t=this.toBER(),i=e.toBER();return ci(t,i)}}q.NAME="BaseBlock";function lr(o){if(o instanceof m.Constructed)for(const e of o.valueBlock.value)lr(e)&&(o.lenBlock.isIndefiniteForm=!0);return!!o.lenBlock.isIndefiniteForm}class cr extends q{constructor({value:e=W,...t}={},i){super(t,i),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,i){const s=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return s===-1?(this.error=this.valueBlock.error,s):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),s)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}cr.NAME="BaseStringBlock";class ur extends ue(Z){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}ur.NAME="PrimitiveValueBlock";var ar;class fr extends q{constructor(e={}){super(e,ur),this.idBlock.isConstructed=!1}}ar=fr;m.Primitive=ar;fr.NAME="PRIMITIVE";function Bi(o,e){if(o instanceof e)return o;const t=new e;return t.idBlock=o.idBlock,t.lenBlock=o.lenBlock,t.warnings=o.warnings,t.valueBeforeDecodeView=o.valueBeforeDecodeView,t}function Oe(o,e=0,t=o.length){const i=e;let s=new q({},Z);const l=new xe;if(!ce(l,o,e,t))return s.error=l.error,{offset:-1,result:s};if(!o.subarray(e,e+t).length)return s.error="Zero buffer length",{offset:-1,result:s};let g=s.idBlock.fromBER(o,e,t);if(s.idBlock.warnings.length&&s.warnings.concat(s.idBlock.warnings),g===-1)return s.error=s.idBlock.error,{offset:-1,result:s};if(e=g,t-=s.idBlock.blockLength,g=s.lenBlock.fromBER(o,e,t),s.lenBlock.warnings.length&&s.warnings.concat(s.lenBlock.warnings),g===-1)return s.error=s.lenBlock.error,{offset:-1,result:s};if(e=g,t-=s.lenBlock.blockLength,!s.idBlock.isConstructed&&s.lenBlock.isIndefiniteForm)return s.error="Indefinite length form used for primitive encoding form",{offset:-1,result:s};let d=q;switch(s.idBlock.tagClass){case 1:if(s.idBlock.tagNumber>=37&&s.idBlock.isHexOnly===!1)return s.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:s};switch(s.idBlock.tagNumber){case 0:if(s.idBlock.isConstructed&&s.lenBlock.length>0)return s.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:s};d=m.EndOfContent;break;case 1:d=m.Boolean;break;case 2:d=m.Integer;break;case 3:d=m.BitString;break;case 4:d=m.OctetString;break;case 5:d=m.Null;break;case 6:d=m.ObjectIdentifier;break;case 10:d=m.Enumerated;break;case 12:d=m.Utf8String;break;case 13:d=m.RelativeObjectIdentifier;break;case 14:d=m.TIME;break;case 15:return s.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:s};case 16:d=m.Sequence;break;case 17:d=m.Set;break;case 18:d=m.NumericString;break;case 19:d=m.PrintableString;break;case 20:d=m.TeletexString;break;case 21:d=m.VideotexString;break;case 22:d=m.IA5String;break;case 23:d=m.UTCTime;break;case 24:d=m.GeneralizedTime;break;case 25:d=m.GraphicString;break;case 26:d=m.VisibleString;break;case 27:d=m.GeneralString;break;case 28:d=m.UniversalString;break;case 29:d=m.CharacterString;break;case 30:d=m.BmpString;break;case 31:d=m.DATE;break;case 32:d=m.TimeOfDay;break;case 33:d=m.DateTime;break;case 34:d=m.Duration;break;default:{const B=s.idBlock.isConstructed?new m.Constructed:new m.Primitive;B.idBlock=s.idBlock,B.lenBlock=s.lenBlock,B.warnings=s.warnings,s=B}}break;case 2:case 3:case 4:default:d=s.idBlock.isConstructed?m.Constructed:m.Primitive}return s=Bi(s,d),g=s.fromBER(o,e,s.lenBlock.isIndefiniteForm?t:s.lenBlock.length),s.valueBeforeDecodeView=o.subarray(i,i+s.blockLength),{offset:g,result:s}}function xi(o,e){return o?1:e}class ge extends Z{constructor({value:e=[],isIndefiniteForm:t=!1,...i}={}){super(i),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,i){const s=V.toUint8Array(e);if(!ce(this,s,t,i))return-1;if(this.valueBeforeDecodeView=s.subarray(t,t+i),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),t;let l=t;for(;xi(this.isIndefiniteForm,i)>0;){const u=Oe(s,l,i);if(u.offset===-1)return this.error=u.result.error,this.warnings.concat(u.result.warnings),-1;if(l=u.offset,this.blockLength+=u.result.blockLength,i-=u.result.blockLength,this.value.push(u.result),this.isIndefiniteForm&&u.result.constructor.NAME===Le)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Le?this.value.pop():this.warnings.push("No EndOfContent block encoded")),l}toBER(e,t){const i=t||new lt;for(let s=0;s<this.value.length;s++)this.value[s].toBER(e,i);return t?te:i.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}ge.NAME="ConstructedValueBlock";var hr;class Ue extends q{constructor(e={}){super(e,ge),this.idBlock.isConstructed=!0}fromBER(e,t,i){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const s=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return s===-1?(this.error=this.valueBlock.error,s):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),s)}onAsciiEncoding(){const e=[];for(const i of this.valueBlock.value)e.push(i.toString("ascii").split(`
`).map(s=>`  ${s}`).join(`
`));const t=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join(`
`)}`:`${t} :`}}hr=Ue;m.Constructed=hr;Ue.NAME="CONSTRUCTED";class dr extends Z{fromBER(e,t,i){return t}toBER(e){return te}}dr.override="EndOfContentValueBlock";var gr;class wr extends q{constructor(e={}){super(e,dr),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}gr=wr;m.EndOfContent=gr;wr.NAME=Le;var yr;class Br extends q{constructor(e={}){super(e,Z),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,i){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=i,t+i>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+i}toBER(e,t){const i=new ArrayBuffer(2);if(!e){const s=new Uint8Array(i);s[0]=5,s[1]=0}return t&&t.write(i),i}onAsciiEncoding(){return`${this.constructor.NAME}`}}yr=Br;m.Null=yr;Br.NAME="NULL";class xr extends ue(Z){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=V.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,i){const s=V.toUint8Array(e);return ce(this,s,t,i)?(this.valueHexView=s.subarray(t,t+i),i>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,rr.call(this),this.blockLength=i,t+i):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}xr.NAME="BooleanValueBlock";var pr;class br extends q{constructor(e={}){super(e,xr),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}pr=br;m.Boolean=pr;br.NAME="BOOLEAN";class mr extends ue(ge){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,i){let s=0;if(this.isConstructed){if(this.isHexOnly=!1,s=ge.prototype.fromBER.call(this,e,t,i),s===-1)return s;for(let l=0;l<this.value.length;l++){const u=this.value[l].constructor.NAME;if(u===Le){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(u!==nr)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,s=super.fromBER(e,t,i),this.blockLength=i;return s}toBER(e,t){return this.isConstructed?ge.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}mr.NAME="OctetStringValueBlock";var kr;class je extends q{constructor({idBlock:e={},lenBlock:t={},...i}={}){var s,l;(s=i.isConstructed)!==null&&s!==void 0||(i.isConstructed=!!(!((l=i.value)===null||l===void 0)&&l.length)),super({idBlock:{isConstructed:i.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!i.isIndefiniteForm},...i},mr),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,i){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,i===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const l=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+i);try{if(l.byteLength){const u=Oe(l,0,l.byteLength);u.offset!==-1&&u.offset===i&&(this.valueBlock.value=[u.result])}}catch{}}return super.fromBER(e,t,i)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?Ue.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${H.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof je&&e.push(t.valueBlock.valueHexView);return V.concat(e)}}kr=je;m.OctetString=kr;je.NAME=nr;class Er extends ue(ge){constructor({unusedBits:e=0,isConstructed:t=!1,...i}={}){super(i),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,i){if(!i)return t;let s=-1;if(this.isConstructed){if(s=ge.prototype.fromBER.call(this,e,t,i),s===-1)return s;for(const g of this.value){const d=g.constructor.NAME;if(d===Le){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(d!==ir)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const B=g.valueBlock;if(this.unusedBits>0&&B.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=B.unusedBits}return s}const l=V.toUint8Array(e);if(!ce(this,l,t,i))return-1;const u=l.subarray(t,t+i);if(this.unusedBits=u[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const g=u.subarray(1);try{if(g.byteLength){const d=Oe(g,0,g.byteLength);d.offset!==-1&&d.offset===i-1&&(this.value=[d.result])}}catch{}}return this.valueHexView=u.subarray(1),this.blockLength=u.length,t+i}toBER(e,t){if(this.isConstructed)return ge.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return te;const i=new Uint8Array(this.valueHexView.length+1);return i[0]=this.unusedBits,i.set(this.valueHexView,1),i.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}Er.NAME="BitStringValueBlock";var Ar;class vr extends q{constructor({idBlock:e={},lenBlock:t={},...i}={}){var s,l;(s=i.isConstructed)!==null&&s!==void 0||(i.isConstructed=!!(!((l=i.value)===null||l===void 0)&&l.length)),super({idBlock:{isConstructed:i.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!i.isIndefiniteForm},...i},Er),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,i){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,i)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Ue.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const s of t)e.push(s.toString(2).padStart(8,"0"));const i=e.join("");return`${this.constructor.NAME} : ${i.substring(0,i.length-this.valueBlock.unusedBits)}`}}}Ar=vr;m.BitString=Ar;vr.NAME=ir;var Ur;function pi(o,e){const t=new Uint8Array([0]),i=new Uint8Array(o),s=new Uint8Array(e);let l=i.slice(0);const u=l.length-1,g=s.slice(0),d=g.length-1;let B=0;const f=d<u?u:d;let p=0;for(let v=f;v>=0;v--,p++){switch(!0){case p<g.length:B=l[u-p]+g[d-p]+t[0];break;default:B=l[u-p]+t[0]}switch(t[0]=B/10,!0){case p>=l.length:l=rt(new Uint8Array([B%10]),l);break;default:l[u-p]=B%10}}return t[0]>0&&(l=rt(t,l)),l}function Ct(o){if(o>=Ce.length)for(let e=Ce.length;e<=o;e++){const t=new Uint8Array([0]);let i=Ce[e-1].slice(0);for(let s=i.length-1;s>=0;s--){const l=new Uint8Array([(i[s]<<1)+t[0]]);t[0]=l[0]/10,i[s]=l[0]%10}t[0]>0&&(i=rt(t,i)),Ce.push(i)}return Ce[o]}function bi(o,e){let t=0;const i=new Uint8Array(o),s=new Uint8Array(e),l=i.slice(0),u=l.length-1,g=s.slice(0),d=g.length-1;let B,f=0;for(let p=d;p>=0;p--,f++)switch(B=l[u-f]-g[d-f]-t,!0){case B<0:t=1,l[u-f]=B+10;break;default:t=0,l[u-f]=B}if(t>0)for(let p=u-d+1;p>=0;p--,f++)if(B=l[u-f]-t,B<0)t=1,l[u-f]=B+10;else{t=0,l[u-f]=B;break}return l.slice()}class ut extends ue(Z){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),e!==void 0&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=rr.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(li(e))}get valueDec(){return this._valueDec}fromDER(e,t,i,s=0){const l=this.fromBER(e,t,i);if(l===-1)return l;const u=this.valueHexView;return u[0]===0&&u[1]&128?this.valueHexView=u.subarray(1):s!==0&&u.length<s&&(s-u.length>1&&(s=u.length+1),this.valueHexView=u.subarray(s-u.length)),l}toDER(e=!1){const t=this.valueHexView;switch(!0){case(t[0]&128)!==0:{const i=new Uint8Array(this.valueHexView.length+1);i[0]=0,i.set(t,1),this.valueHexView=i}break;case(t[0]===0&&(t[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(e)}fromBER(e,t,i){const s=super.fromBER(e,t,i);return s===-1||this.setValueHex(),s}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=this.valueHexView.length*8-1;let t=new Uint8Array(this.valueHexView.length*8/3),i=0,s;const l=this.valueHexView;let u="",g=!1;for(let d=l.byteLength-1;d>=0;d--){s=l[d];for(let B=0;B<8;B++){if((s&1)===1)switch(i){case e:t=bi(Ct(i),t),u="-";break;default:t=pi(t,Ct(i))}i++,s>>=1}}for(let d=0;d<t.length;d++)t[d]&&(g=!0),g&&(u+=Nt.charAt(t[d]));return g===!1&&(u+=Nt.charAt(0)),u}}Ur=ut;ut.NAME="IntegerValueBlock";Object.defineProperty(Ur.prototype,"valueHex",{set:function(o){this.valueHexView=new Uint8Array(o),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var Ir;class le extends q{constructor(e={}){super(e,ut),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return De(),BigInt(this.valueBlock.toString())}static fromBigInt(e){De();const t=BigInt(e),i=new lt,s=t.toString(16).replace(/^-/,""),l=new Uint8Array(H.FromHex(s));if(t<0){const g=new Uint8Array(l.length+(l[0]&128?1:0));g[0]|=128;const B=BigInt(`0x${H.ToHex(g)}`)+t,f=V.toUint8Array(H.FromHex(B.toString(16)));f[0]|=128,i.write(f)}else l[0]&128&&i.write(new Uint8Array([0])),i.write(l);return new le({valueHex:i.final()})}convertToDER(){const e=new le({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new le({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Ir=le;m.Integer=Ir;le.NAME="INTEGER";var Nr;class Sr extends le{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Nr=Sr;m.Enumerated=Nr;Sr.NAME="ENUMERATED";class nt extends ue(Z){constructor({valueDec:e=-1,isFirstSid:t=!1,...i}={}){super(i),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,i){if(!i)return t;const s=V.toUint8Array(e);if(!ce(this,s,t,i))return-1;const l=s.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let g=0;g<i&&(this.valueHexView[g]=l[g]&127,this.blockLength++,!!(l[g]&128));g++);const u=new Uint8Array(this.blockLength);for(let g=0;g<this.blockLength;g++)u[g]=this.valueHexView[g];return this.valueHexView=u,l[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=ve(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){De();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const i=new Uint8Array(t.length/7);for(let s=0;s<i.length;s++)i[s]=parseInt(t.slice(s*7,s*7+7),2)+(s+1<i.length?128:0);this.fromBER(i.buffer,0,i.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const s=this.valueHexView,l=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)l[u]=s[u]|128;return l[this.blockLength-1]=s[this.blockLength-1],l.buffer}const t=Be(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",te;const i=new Uint8Array(t.byteLength);if(!e){const s=new Uint8Array(t),l=t.byteLength-1;for(let u=0;u<l;u++)i[u]=s[u]|128;i[l]=s[l]}return i}toString(){let e="";if(this.isHexOnly)e=H.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}nt.NAME="sidBlock";class Cr extends Z{constructor({value:e=W,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let s=t;for(;i>0;){const l=new nt;if(s=l.fromBER(e,s,i),s===-1)return this.blockLength=0,this.error=l.error,s;this.value.length===0&&(l.isFirstSid=!0),this.blockLength+=l.blockLength,i-=l.blockLength,this.value.push(l)}return s}toBER(e){const t=[];for(let i=0;i<this.value.length;i++){const s=this.value[i].toBER(e);if(s.byteLength===0)return this.error=this.value[i].error,te;t.push(s)}return ot(t)}fromString(e){this.value=[];let t=0,i=0,s="",l=!1;do if(i=e.indexOf(".",t),i===-1?s=e.substring(t):s=e.substring(t,i),t=i+1,l){const u=this.value[0];let g=0;switch(u.valueDec){case 0:break;case 1:g=40;break;case 2:g=80;break;default:this.value=[];return}const d=parseInt(s,10);if(isNaN(d))return;u.valueDec=d+g,l=!1}else{const u=new nt;if(s>Number.MAX_SAFE_INTEGER){De();const g=BigInt(s);u.valueBigInt=g}else if(u.valueDec=parseInt(s,10),isNaN(u.valueDec))return;this.value.length||(u.isFirstSid=!0,l=!0),this.value.push(u)}while(i!==-1)}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let s=this.value[i].toString();i!==0&&(e=`${e}.`),t?(s=`{${s}}`,this.value[i].isFirstSid?e=`2.{${s} - 80}`:e+=s):e+=s}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Cr.NAME="ObjectIdentifierValueBlock";var Fr;class Vr extends q{constructor(e={}){super(e,Cr),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Fr=Vr;m.ObjectIdentifier=Fr;Vr.NAME="OBJECT IDENTIFIER";class it extends ue(xe){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,i){if(i===0)return t;const s=V.toUint8Array(e);if(!ce(this,s,t,i))return-1;const l=s.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let g=0;g<i&&(this.valueHexView[g]=l[g]&127,this.blockLength++,!!(l[g]&128));g++);const u=new Uint8Array(this.blockLength);for(let g=0;g<this.blockLength;g++)u[g]=this.valueHexView[g];return this.valueHexView=u,l[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=ve(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const s=this.valueHexView,l=new Uint8Array(this.blockLength);for(let u=0;u<this.blockLength-1;u++)l[u]=s[u]|128;return l[this.blockLength-1]=s[this.blockLength-1],l.buffer}const t=Be(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",te;const i=new Uint8Array(t.byteLength);if(!e){const s=new Uint8Array(t),l=t.byteLength-1;for(let u=0;u<l;u++)i[u]=s[u]|128;i[l]=s[l]}return i.buffer}toString(){let e="";return this.isHexOnly?e=H.ToHex(this.valueHexView):e=this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}it.NAME="relativeSidBlock";class Tr extends Z{constructor({value:e=W,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let s=t;for(;i>0;){const l=new it;if(s=l.fromBER(e,s,i),s===-1)return this.blockLength=0,this.error=l.error,s;this.blockLength+=l.blockLength,i-=l.blockLength,this.value.push(l)}return s}toBER(e,t){const i=[];for(let s=0;s<this.value.length;s++){const l=this.value[s].toBER(e);if(l.byteLength===0)return this.error=this.value[s].error,te;i.push(l)}return ot(i)}fromString(e){this.value=[];let t=0,i=0,s="";do{i=e.indexOf(".",t),i===-1?s=e.substring(t):s=e.substring(t,i),t=i+1;const l=new it;if(l.valueDec=parseInt(s,10),isNaN(l.valueDec))return!0;this.value.push(l)}while(i!==-1);return!0}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let s=this.value[i].toString();i!==0&&(e=`${e}.`),t&&(s=`{${s}}`),e+=s}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Tr.NAME="RelativeObjectIdentifierValueBlock";var Lr;class Or extends q{constructor(e={}){super(e,Tr),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Lr=Or;m.RelativeObjectIdentifier=Lr;Or.NAME="RelativeObjectIdentifier";var Rr;class at extends Ue{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}Rr=at;m.Sequence=Rr;at.NAME="SEQUENCE";var _r;class Hr extends Ue{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}_r=Hr;m.Set=_r;Hr.NAME="SET";class Mr extends ue(Z){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=W}toJSON(){return{...super.toJSON(),value:this.value}}}Mr.NAME="StringValueBlock";class Dr extends Mr{}Dr.NAME="SimpleStringValueBlock";class Q extends cr{constructor({...e}={}){super(e,Dr)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,V.toUint8Array(e))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=e.charCodeAt(s);this.valueBlock.value=e}}Q.NAME="SIMPLE STRING";class $r extends Q{fromBuffer(e){this.valueBlock.valueHexView=V.toUint8Array(e);try{this.valueBlock.value=H.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=H.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(H.FromUtf8String(e)),this.valueBlock.value=e}}$r.NAME="Utf8StringValueBlock";var Pr;class pe extends $r{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Pr=pe;m.Utf8String=Pr;pe.NAME="UTF8String";class jr extends Q{fromBuffer(e){this.valueBlock.value=H.ToUtf16String(e),this.valueBlock.valueHexView=V.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(H.FromUtf16String(e))}}jr.NAME="BmpStringValueBlock";var Gr;class Jr extends jr{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Gr=Jr;m.BmpString=Gr;Jr.NAME="BMPString";class Wr extends Q{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),i=new Uint8Array(t);for(let s=0;s<i.length;s+=4)i[s]=i[s+3],i[s+1]=i[s+2],i[s+2]=0,i[s+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(t*4);for(let s=0;s<t;s++){const l=Be(e.charCodeAt(s),8),u=new Uint8Array(l);if(u.length>4)continue;const g=4-u.length;for(let d=u.length-1;d>=0;d--)i[s*4+d+g]=u[d]}this.valueBlock.value=e}}Wr.NAME="UniversalStringValueBlock";var qr;class Yr extends Wr{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}qr=Yr;m.UniversalString=qr;Yr.NAME="UniversalString";var Kr;class Xr extends Q{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}Kr=Xr;m.NumericString=Kr;Xr.NAME="NumericString";var zr;class Zr extends Q{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}zr=Zr;m.PrintableString=zr;Zr.NAME="PrintableString";var Qr;class en extends Q{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Qr=en;m.TeletexString=Qr;en.NAME="TeletexString";var tn;class rn extends Q{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}tn=rn;m.VideotexString=tn;rn.NAME="VideotexString";var nn;class sn extends Q{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}nn=sn;m.IA5String=nn;sn.NAME="IA5String";var on;class ln extends Q{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}on=ln;m.GraphicString=on;ln.NAME="GraphicString";var cn;class ft extends Q{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}cn=ft;m.VisibleString=cn;ft.NAME="VisibleString";var un;class an extends Q{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}un=an;m.GeneralString=un;an.NAME="GeneralString";var fn;class hn extends Q{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}fn=hn;m.CharacterString=fn;hn.NAME="CharacterString";var dn;class ht extends ft{constructor({value:e,valueDate:t,...i}={}){if(super(i),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let s=0;s<e.length;s++)this.valueBlock.valueHexView[s]=e.charCodeAt(s)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,V.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),i=new Uint8Array(t);for(let s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const i=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(i===null){this.error="Wrong input string for conversion";return}const s=parseInt(i[1],10);s>=50?this.year=1900+s:this.year=2e3+s,this.month=parseInt(i[2],10),this.day=parseInt(i[3],10),this.hour=parseInt(i[4],10),this.minute=parseInt(i[5],10),this.second=parseInt(i[6],10)}toString(e="iso"){if(e==="iso"){const t=new Array(7);return t[0]=z(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=z(this.month,2),t[2]=z(this.day,2),t[3]=z(this.hour,2),t[4]=z(this.minute,2),t[5]=z(this.second,2),t[6]="Z",t.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}dn=ht;m.UTCTime=dn;ht.NAME="UTCTime";var gn;class wn extends ht{constructor(e={}){var t;super(e),(t=this.millisecond)!==null&&t!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t=!1,i="",s="",l=0,u,g=0,d=0;if(e[e.length-1]==="Z")i=e.substring(0,e.length-1),t=!0;else{const p=new Number(e[e.length-1]);if(isNaN(p.valueOf()))throw new Error("Wrong input string for conversion");i=e}if(t){if(i.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(i.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let p=1,v=i.indexOf("+"),I="";if(v===-1&&(v=i.indexOf("-"),p=-1),v!==-1){if(I=i.substring(v+1),i=i.substring(0,v),I.length!==2&&I.length!==4)throw new Error("Wrong input string for conversion");let D=parseInt(I.substring(0,2),10);if(isNaN(D.valueOf()))throw new Error("Wrong input string for conversion");if(g=p*D,I.length===4){if(D=parseInt(I.substring(2,4),10),isNaN(D.valueOf()))throw new Error("Wrong input string for conversion");d=p*D}}}let B=i.indexOf(".");if(B===-1&&(B=i.indexOf(",")),B!==-1){const p=new Number(`0${i.substring(B)}`);if(isNaN(p.valueOf()))throw new Error("Wrong input string for conversion");l=p.valueOf(),s=i.substring(0,B)}else s=i;switch(!0){case s.length===8:if(u=/(\d{4})(\d{2})(\d{2})/ig,B!==-1)throw new Error("Wrong input string for conversion");break;case s.length===10:if(u=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,B!==-1){let p=60*l;this.minute=Math.floor(p),p=60*(p-this.minute),this.second=Math.floor(p),p=1e3*(p-this.second),this.millisecond=Math.floor(p)}break;case s.length===12:if(u=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,B!==-1){let p=60*l;this.second=Math.floor(p),p=1e3*(p-this.second),this.millisecond=Math.floor(p)}break;case s.length===14:if(u=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,B!==-1){const p=1e3*l;this.millisecond=Math.floor(p)}break;default:throw new Error("Wrong input string for conversion")}const f=u.exec(s);if(f===null)throw new Error("Wrong input string for conversion");for(let p=1;p<f.length;p++)switch(p){case 1:this.year=parseInt(f[p],10);break;case 2:this.month=parseInt(f[p],10);break;case 3:this.day=parseInt(f[p],10);break;case 4:this.hour=parseInt(f[p],10)+g;break;case 5:this.minute=parseInt(f[p],10)+d;break;case 6:this.second=parseInt(f[p],10);break;default:throw new Error("Wrong input string for conversion")}if(t===!1){const p=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=p.getUTCFullYear(),this.month=p.getUTCMonth(),this.day=p.getUTCDay(),this.hour=p.getUTCHours(),this.minute=p.getUTCMinutes(),this.second=p.getUTCSeconds(),this.millisecond=p.getUTCMilliseconds()}}toString(e="iso"){if(e==="iso"){const t=[];return t.push(z(this.year,4)),t.push(z(this.month,2)),t.push(z(this.day,2)),t.push(z(this.hour,2)),t.push(z(this.minute,2)),t.push(z(this.second,2)),this.millisecond!==0&&(t.push("."),t.push(z(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}gn=wn;m.GeneralizedTime=gn;wn.NAME="GeneralizedTime";var yn;class Bn extends pe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}yn=Bn;m.DATE=yn;Bn.NAME="DATE";var xn;class pn extends pe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}xn=pn;m.TimeOfDay=xn;pn.NAME="TimeOfDay";var bn;class mn extends pe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}bn=mn;m.DateTime=bn;mn.NAME="DateTime";var kn;class En extends pe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}kn=En;m.Duration=kn;En.NAME="Duration";var An;class vn extends pe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}An=vn;m.TIME=An;vn.NAME="TIME";class $e{constructor({name:e=W,optional:t=!1}={}){this.name=e,this.optional=t}}class mi extends $e{constructor({value:e=[],...t}={}){super(t),this.value=e}}class Ft extends $e{constructor({value:e=new $e,local:t=!1,...i}={}){super(i),this.value=e,this.local=t}}function Ve(o,e,t){if(t instanceof mi){for(let l=0;l<t.value.length;l++)if(Ve(o,e,t.value[l]).verified)return{verified:!0,result:o};{const l={verified:!1,result:{error:"Wrong values for Choice type"}};return t.hasOwnProperty(Ze)&&(l.name=t.name),l}}if(t instanceof $e)return t.hasOwnProperty(Ze)&&(o[t.name]=e),{verified:!0,result:o};if(!(o instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(ai in t))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(gi in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(wi in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=t.idBlock.toBER(!1);if(i.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(t.idBlock.fromBER(i,0,i.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(t.idBlock.hasOwnProperty(fi)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagClass!==e.idBlock.tagClass)return{verified:!1,result:o};if(t.idBlock.hasOwnProperty(hi)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagNumber!==e.idBlock.tagNumber)return{verified:!1,result:o};if(t.idBlock.hasOwnProperty(di)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isConstructed!==e.idBlock.isConstructed)return{verified:!1,result:o};if(!(ui in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isHexOnly!==e.idBlock.isHexOnly)return{verified:!1,result:o};if(t.idBlock.isHexOnly){if(!(St in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const l=t.idBlock.valueHexView,u=e.idBlock.valueHexView;if(l.length!==u.length)return{verified:!1,result:o};for(let g=0;g<l.length;g++)if(l[g]!==u[1])return{verified:!1,result:o}}if(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,W),t.name&&(o[t.name]=e)),t instanceof m.Constructed){let l=0,u={verified:!1,result:{error:"Unknown error"}},g=t.valueBlock.value.length;if(g>0&&t.valueBlock.value[0]instanceof Ft&&(g=e.valueBlock.value.length),g===0)return{verified:!0,result:o};if(e.valueBlock.value.length===0&&t.valueBlock.value.length!==0){let d=!0;for(let B=0;B<t.valueBlock.value.length;B++)d=d&&(t.valueBlock.value[B].optional||!1);return d?{verified:!0,result:o}:(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,W),t.name&&delete o[t.name]),o.error="Inconsistent object length",{verified:!1,result:o})}for(let d=0;d<g;d++)if(d-l>=e.valueBlock.value.length){if(t.valueBlock.value[d].optional===!1){const B={verified:!1,result:o};return o.error="Inconsistent length between ASN.1 data and schema",t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,W),t.name&&(delete o[t.name],B.name=t.name)),B}}else if(t.valueBlock.value[0]instanceof Ft){if(u=Ve(o,e.valueBlock.value[d],t.valueBlock.value[0].value),u.verified===!1)if(t.valueBlock.value[0].optional)l++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,W),t.name&&delete o[t.name]),u;if(Ze in t.valueBlock.value[0]&&t.valueBlock.value[0].name.length>0){let B={};yi in t.valueBlock.value[0]&&t.valueBlock.value[0].local?B=e:B=o,typeof B[t.valueBlock.value[0].name]>"u"&&(B[t.valueBlock.value[0].name]=[]),B[t.valueBlock.value[0].name].push(e.valueBlock.value[d])}}else if(u=Ve(o,e.valueBlock.value[d-l],t.valueBlock.value[d]),u.verified===!1)if(t.valueBlock.value[d].optional)l++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,W),t.name&&delete o[t.name]),u;if(u.verified===!1){const d={verified:!1,result:o};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,W),t.name&&(delete o[t.name],d.name=t.name)),d}return{verified:!0,result:o}}if(t.primitiveSchema&&St in e.valueBlock){const l=Oe(e.valueBlock.valueHexView);if(l.offset===-1){const u={verified:!1,result:l.result};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,W),t.name&&(delete o[t.name],u.name=t.name)),u}return Ve(o,l.result,t.primitiveSchema)}return{verified:!0,result:o}}function ki(o,e){if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const t=Oe(V.toUint8Array(o));return t.offset===-1?{verified:!1,result:t.result}:Ve(t.result,t.result,e)}const Ei="6.13.3";function Vt(o,e,t){for(let i in e){let s=e[i];Object.defineProperty(o,i,{enumerable:!0,value:s,writable:!1})}}function Ae(o){if(o==null)return"null";if(Array.isArray(o))return"[ "+o.map(Ae).join(", ")+" ]";if(o instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let i=0;i<o.length;i++)t+=e[o[i]>>4],t+=e[o[i]&15];return t}if(typeof o=="object"&&typeof o.toJSON=="function")return Ae(o.toJSON());switch(typeof o){case"boolean":case"symbol":return o.toString();case"bigint":return BigInt(o).toString();case"number":return o.toString();case"string":return JSON.stringify(o);case"object":{const e=Object.keys(o);return e.sort(),"{ "+e.map(t=>`${Ae(t)}: ${Ae(o[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function Ai(o,e,t){let i=o;{const l=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${Ae(t)}`);for(const u in t){if(u==="shortMessage")continue;const g=t[u];l.push(u+"="+Ae(g))}}l.push(`code=${e}`),l.push(`version=${Ei}`),l.length&&(o+=" ("+l.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(o);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(o);break;default:s=new Error(o)}return Vt(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&Vt(s,{shortMessage:i}),s}function vi(o,e,t,i){if(!o)throw Ai(e,t,i)}function Te(o,e,t,i){vi(o,e,"INVALID_ARGUMENT",{argument:t,value:i})}["NFD","NFC","NFKD","NFKC"].reduce((o,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");o.push(e)}catch{}return o},[]);function Ui(o,e,t){if(o instanceof Uint8Array)return o;if(typeof o=="string"&&o.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const i=new Uint8Array((o.length-2)/2);let s=2;for(let l=0;l<i.length;l++)i[l]=parseInt(o.substring(s,s+2),16),s+=2;return i}Te(!1,"invalid BytesLike value",e||"value",o)}function Un(o,e){return Ui(o,e)}const Tt="0123456789abcdef";function Ii(o){const e=Un(o);let t="0x";for(let i=0;i<e.length;i++){const s=e[i];t+=Tt[(s&240)>>4]+Tt[s&15]}return t}BigInt(0);BigInt(1);const Lt=9007199254740991;function Ni(o,e){switch(typeof o){case"bigint":return o;case"number":return Te(Number.isInteger(o),"underflow","value",o),Te(o>=-Lt&&o<=Lt,"overflow","value",o),BigInt(o);case"string":try{if(o==="")throw new Error("empty string");return o[0]==="-"&&o[1]!=="-"?-BigInt(o.substring(1)):BigInt(o)}catch(t){Te(!1,`invalid BigNumberish string: ${t.message}`,"value",o)}}Te(!1,"invalid BigNumberish value","value",o)}const Ot="0123456789abcdef";function Rt(o){if(o instanceof Uint8Array){let e="0x0";for(const t of o)e+=Ot[t>>4],e+=Ot[t&15];return BigInt(e)}return Ni(o)}function _t(o){if(!Number.isSafeInteger(o)||o<0)throw new Error(`Wrong positive integer: ${o}`)}function In(o,...e){if(!(o instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(o.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${o.length}`)}function Ht(o,e=!0){if(o.destroyed)throw new Error("Hash instance has been destroyed");if(e&&o.finished)throw new Error("Hash#digest() has already been called")}function Si(o,e){In(o);const t=e.outputLen;if(o.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ci=o=>o instanceof Uint8Array,Fi=o=>new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)),Vi=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Vi)throw new Error("Non little-endian hardware is not supported");function Ti(o){if(typeof o!="string")throw new Error(`utf8ToBytes expected string, got ${typeof o}`);return new Uint8Array(new TextEncoder().encode(o))}function Nn(o){if(typeof o=="string"&&(o=Ti(o)),!Ci(o))throw new Error(`expected Uint8Array, got ${typeof o}`);return o}class Li{clone(){return this._cloneInto()}}function Oi(o){const e=i=>o().update(Nn(i)).digest(),t=o();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>o(),e}const Me=BigInt(2**32-1),Mt=BigInt(32);function Ri(o,e=!1){return e?{h:Number(o&Me),l:Number(o>>Mt&Me)}:{h:Number(o>>Mt&Me)|0,l:Number(o&Me)|0}}function _i(o,e=!1){let t=new Uint32Array(o.length),i=new Uint32Array(o.length);for(let s=0;s<o.length;s++){const{h:l,l:u}=Ri(o[s],e);[t[s],i[s]]=[l,u]}return[t,i]}const Hi=(o,e,t)=>o<<t|e>>>32-t,Mi=(o,e,t)=>e<<t|o>>>32-t,Di=(o,e,t)=>e<<t-32|o>>>64-t,$i=(o,e,t)=>o<<t-32|e>>>64-t,[Sn,Cn,Fn]=[[],[],[]],Pi=BigInt(0),Fe=BigInt(1),ji=BigInt(2),Gi=BigInt(7),Ji=BigInt(256),Wi=BigInt(113);for(let o=0,e=Fe,t=1,i=0;o<24;o++){[t,i]=[i,(2*t+3*i)%5],Sn.push(2*(5*i+t)),Cn.push((o+1)*(o+2)/2%64);let s=Pi;for(let l=0;l<7;l++)e=(e<<Fe^(e>>Gi)*Wi)%Ji,e&ji&&(s^=Fe<<(Fe<<BigInt(l))-Fe);Fn.push(s)}const[qi,Yi]=_i(Fn,!0),Dt=(o,e,t)=>t>32?Di(o,e,t):Hi(o,e,t),$t=(o,e,t)=>t>32?$i(o,e,t):Mi(o,e,t);function Ki(o,e=24){const t=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let u=0;u<10;u++)t[u]=o[u]^o[u+10]^o[u+20]^o[u+30]^o[u+40];for(let u=0;u<10;u+=2){const g=(u+8)%10,d=(u+2)%10,B=t[d],f=t[d+1],p=Dt(B,f,1)^t[g],v=$t(B,f,1)^t[g+1];for(let I=0;I<50;I+=10)o[u+I]^=p,o[u+I+1]^=v}let s=o[2],l=o[3];for(let u=0;u<24;u++){const g=Cn[u],d=Dt(s,l,g),B=$t(s,l,g),f=Sn[u];s=o[f],l=o[f+1],o[f]=d,o[f+1]=B}for(let u=0;u<50;u+=10){for(let g=0;g<10;g++)t[g]=o[u+g];for(let g=0;g<10;g++)o[u+g]^=~t[(g+2)%10]&t[(g+4)%10]}o[0]^=qi[i],o[1]^=Yi[i]}t.fill(0)}class dt extends Li{constructor(e,t,i,s=!1,l=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=i,this.enableXOF=s,this.rounds=l,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,_t(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Fi(this.state)}keccak(){Ki(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Ht(this);const{blockLen:t,state:i}=this;e=Nn(e);const s=e.length;for(let l=0;l<s;){const u=Math.min(t-this.pos,s-l);for(let g=0;g<u;g++)i[this.pos++]^=e[l++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:i,blockLen:s}=this;e[i]^=t,t&128&&i===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Ht(this,!1),In(e),this.finish();const t=this.state,{blockLen:i}=this;for(let s=0,l=e.length;s<l;){this.posOut>=i&&this.keccak();const u=Math.min(i-this.posOut,l-s);e.set(t.subarray(this.posOut,this.posOut+u),s),this.posOut+=u,s+=u}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return _t(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Si(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:i,outputLen:s,rounds:l,enableXOF:u}=this;return e||(e=new dt(t,i,s,u,l)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=l,e.suffix=i,e.outputLen=s,e.enableXOF=u,e.destroyed=this.destroyed,e}}const Xi=(o,e,t)=>Oi(()=>new dt(e,o,t)),zi=Xi(1,136,256/8);let Vn=!1;const Tn=function(o){return zi(o)};let Ln=Tn;function Re(o){const e=Un(o,"data");return Ii(Ln(e))}Re._=Tn;Re.lock=function(){Vn=!0};Re.register=function(o){if(Vn)throw new TypeError("keccak256 is locked");Ln=o};Object.freeze(Re);function Zi(o){return o[0]<<24|o[1]<<16|o[2]<<8|o[3]}function Qi(o){return o[0]<<8|o[1]}function es(o){const e=Qt.decode(o),t=e[1];if(t==2){const i={kty:t,alg:e[3],crv:e[-1],x:Rt(e[-2]),y:Rt(e[-3])};if(!(i.alg==-7&&i.crv==1)&&!(i.alg==-8&&i.crv==6))throw new Error(`Unknown alg: ${i.alg}, crv: ${i.crv}`);return i}throw new Error(`Unsupported kty: ${t}`)}function ts(o){if(o.byteLength-o.byteOffset<37)throw new Error("Attestation Object must be at least 37 bytes or longer");const e=o.slice(32,33)[0],t={rpIdHash:o.slice(0,32),flags:{UP:(e&1)!=0,UV:(e&4)!=0,BE:(e&8)!=0,BS:(e&16)!=0,AT:(e&64)!=0,ED:(e&128)!=0},signCount:Zi(o.slice(33,37))};if(t.flags.ED)throw new Error("Extension Data not supported!");if(t.flags.AT){const i=Qi(o.slice(53,55));t.attestedCredentialData={aaguid:o.slice(37,53),credentialId:o.slice(55,55+i),credentialPublicKey:es(o.slice(55+i).buffer)}}return t}function rs(o){const t=Qt.decode(new Uint8Array(o).buffer).authData;return ts(t)}async function ns(o,e,t){const i=await navigator.credentials.create({publicKey:{attestation:"none",challenge:t.buffer,pubKeyCredParams:[{alg:-7,type:"public-key"}],rp:o,user:e}});if(!i)throw new Error("No PublicKeyCredential returned!");const s=i.response,l=new TextDecoder("utf-8").decode(s.clientDataJSON);return{id:new Uint8Array(i.rawId),cd:l,ad:rs(s.attestationObject)}}function is(o){return Object.entries(o).map(([e,t])=>{if(typeof t=="boolean")return{t:1,k:e,v:t?"true":"false"};if(typeof t=="string")return{t:0,k:e,v:t};throw new Error(`Incompatible value type! Key:${e} Value:${t}`)})}const ss=new at({name:"sig",value:[new le({name:"r"}),new le({name:"s"})]});async function os(o,e){e||(e=crypto.getRandomValues(new Uint8Array(32)));const t=await navigator.credentials.get({publicKey:{allowCredentials:o.map(B=>({id:B,type:"public-key"})),challenge:e}}),i=t.response,s=ki(i.signature,ss);if(!s.verified)throw new Error("Unable to decode ASN.1 signature!");const l=s.result,u=l.r.toBigInt(),g=l.s.toBigInt(),d=JSON.parse(new TextDecoder().decode(i.clientDataJSON));return{credentialIdHashed:Re(new Uint8Array(t.rawId)),challenge:e,resp:{authenticatorData:new Uint8Array(i.authenticatorData),clientDataTokens:is(d),sigR:u,sigS:g}}}window.addEventListener("message",o=>{o.data.type==="create"?(console.log(o),ls(o.data.id,o.data.content)):o.data.type==="get"&&cs(o.data.id,o.data.content)});async function ls(o,e){var i;const t=await ns({name:"Embedded Wallet Account",id:window.location.hostname},{id:e.hashedUsername,name:e.username,displayName:e.username},crypto.getRandomValues(new Uint8Array(32)));(i=window.top)==null||i.postMessage({type:"apillon_pk_response",id:o,content:{credentialId:t.id,pubkey:t.ad.attestedCredentialData.credentialPublicKey}},"*")}async function cs(o,e){var i;const t=await os(e.credentials,e.challenge);(i=window.top)==null||i.postMessage({type:"apillon_pk_response",id:o,content:{credentials:t}},"*")}
